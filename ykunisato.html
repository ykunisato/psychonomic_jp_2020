<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>恐怖の再発と潜在原因モデル</title>
    <meta charset="utf-8" />
    <meta name="author" content="国里愛彦" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# 恐怖の再発と潜在原因モデル
## - 計算論的精神医学入門 -
### 国里愛彦
### 専修大学心理学科
### 2020/11/7 日本基礎心理学会第39回大会

---




&lt;!--30分--&gt;

# 国里愛彦（くにさとよしひこ）
- 計算論的アプローチとRと自然をほどよく愛す
- .green[『計算論的精神医学: 情報処理過程から読み解く精神障害』](国里・片平・沖村・山下, 2019年, 勁草書房)

&lt;img src="pic/01.png" width="550"&gt;

---
# 精神障害と生物学的基盤

- 精神障害の本質的な生物学的基盤は不明.med[(multifinal性：同一生物学的基盤から複数障害，equifinal性：複数の生物学的基盤から１つの障害)]

&lt;img src="pic/05.png" width="500"&gt;
- 生物学的基盤（遺伝子，神経回路）と行動や症状との間には，.green[説明のギャップ]がある(心理学に共通する問題？)
---
# 計算論的アプローチとは？

- 計算論的アプローチとは，.green[刺激と反応との間にある脳の情報処理過程を明示的に数理モデルにすることで，脳や心の動作原理を理解する]研究手法である(国里ら, 2019)。

→計算論的アプローチで説明のギャップを埋められるのでは？

- David Marr(1982)の３つの水準（.green[計算理論，表現とアルゴリズム，インプリメンテーション]）から検討する。

→現象の記述だけでなく，プログラム可能なアルゴリズムまで踏み込んだ理解が可能かも？
---

# Marrの3つの水準

&lt;img src="pic/18.png" width="700"&gt;

- 計算理論は問題を設定・制約し，検証可能なアルゴリズムを導く

---

# 計算論的アプローチの方法
&lt;img src="pic/02.png" width="650"&gt;
- 入力から反応が生成される過程をモデル化した.green[データ生成モデル]を仮定することで，シミュレーションやデータから潜在過程が検討できる(国里ら,2018)。

---
# ４つの生成モデル
&lt;img src="pic/13.png" width="800"&gt;
---

# ４つの生成モデルとツールボックス

&lt;img src="pic/19.png" width="800"&gt;

---
# 計算論的アプローチの利点

- 疾病分類とバイオマーカーの洗練化：行動・脳画像データに生成モデルを適用した検査を行う.green[計算論的検査].med[(Computational assay, Stephan &amp; Mathys, 2014)]の開発

- 説明のギャップを埋める：シナプスなどの生物学的な話がどのように行動につながるのか説明できる

- 効果的な治療法・検査法の探索：十分に人の行動・神経活動をシミュレートできる生成モデルがあれば，実験前に探索可能（行動データ測定の最適化にもつながる:.green[適応型デザイン]）
---

# 理論駆動とデータ駆動

- 生成モデルによる.green[理論駆動アプローチ]だけでなく，.green[データ駆動型アプローチ]もある。
- Bishop (2006, PRML)は，機械学習におけるモデルを，.green[生成モデル，識別モデル，識別関数]にわけて説明している.med[（生成モデルは，データとパラメータの同時分布からデータ生成過程を記述するので，入力から人工データが生成できる）]。
- 理論が仮定できない状況においては，データ駆動アプローチも有用（入力系の処理＆教師なしの分類）。
- 計算論的精神医学は，狭くは理論駆動アプローチだが，データ駆動アプローチも含む

---
# 理論駆動とデータ駆動の組み合わせ

&lt;img src="pic/20.png" width="850"&gt;
---

# 計算論的アプローチの例：恐怖の再発

- 復元効果：消去後の消去とは別文脈で恐怖が再発すること
&lt;img src="pic/04.png" width="640"&gt;

.med[復元効果のモデルは提案されているが，決定版がない。復元効果以外には，自然回復，復位効果，再獲得がある。詳しくは中島・遠座(2017)]
---

# 潜在原因モデル(Gershman &amp; Niv, 2012)

&lt;img src="pic/09.png" width="850"&gt;

- 観測されたデータ（CSやUSなど）は，潜在原因からP(観測データ|潜在原因)で生成されると考える（.green[生成過程]）
- 生物は，ベイズ則に基づく.green[生成モデル]を用いて，観測されたデータから潜在原因を推測する。原因の推測＝学習
---

# 潜在原因モデルによる原因の推測

- 原因は離散なので推測に使う生成モデルは，ノンパラメトリックベイズになる。中華料理店過程を用いて，過去に観測されたデータから次の原因を予測する。

.med[→意味不明な名前だが，中華料理店のテーブルに順番に座っていく話で，各テーブルに座っている人の割合に応じて座るモデル（より多くの人が座っているテーブルに座る確率が高い）。なお，ある確率(α)で新しいテーブル（まだ誰も座っていない）に座る。]

→原因は無限にありえるが，中華料理店過程を使うと，原因の数が増えすぎず，生物の認知能力として妥当な数に収まる。

---

# 潜在原因モデルによるシミュレーション
- 潜在原因モデルを使えば，復元効果のシミュレーションが可能になる（ABAデザインだけでなく，ABCデザインでも）
.med[https://github.com/ykunisato/lcmr]
&lt;img src="pic/07.png" width="600"&gt;
---

# 潜在原因の数と恐怖の再発の個人差

- Gershman &amp; Hartley(2015)は，恐怖条件づけの獲得・消去をした次の日に再発テストをしたデータ(141名)に，潜在原因モデルを用いたモデルフィッティングを行った。

→推定された結果から，.green[用いる潜在原因の数が多いほど，再発しやすい]ことが示された。

- Gershman et al.(2013)は，潜在原因を増やさない方法として，段階的消去（一気に消去せず，USは少し残しずつ消去する）を提案した。

→動物実験で，.green[段階的消去の方が再発が少ない]ことを示した。

---
# 潜在原因モデルを使うには

- GershmanがMatlabコードをGithubに公開(https://github.com/sjgershm/LCM)
- 国里がMatlabからRに移植したRパッケージをGithubで公開(https://github.com/ykunisato/lcmr )
- Rユーザーだとlcmrが便利。

- lcmrは改良中：C++による高速化(完了)，粒子群最適化による推定(完了)，Latent Cause Modulated Rescorla-Wagner model: LCM-RWのパラメータ推定(パラメータリカバリーがまだ上手くいかない)

---
# 実データに潜在原因モデルを使ってみる

- 68名の大学生に恐怖条件づけ実験を実施(CS:図形刺激，US:恐怖顔と叫び声）。アウトカムはUS予期.small[（再発効果は再現せず...）]
-  `\(\alpha\)` の高い人の方が，US予期の変動性が大きい。

&lt;img src="pic/17.png" width="550"&gt;
---
# 潜在原因の数（α）と恐怖の獲得・消去
-  `\(\alpha\)` が高い方が（原因が多い方が），CS-への反応が低くなりにくい（弁別が弱いor般化しやすい？）。

&lt;img src="pic/17.png" width="650"&gt;
---
# 潜在原因モデルのまとめ

- 恐怖条件づけの再発過程のモデルとして潜在原因モデルは魅力的な説明を提供する

- 実データに潜在原因モデルを適用した研究が少ないので，パラメータ推定方法についての工夫がまだ分からない。

- パラメータの解釈は，モデルからできるわけだが，粒子フィルターの挙動を掴むのに苦労する・・・

→まだ国里の鍛錬が必要です・・・
---
# 再現性の危機と行動課題

- 心理学研究100本のうち再現されたのは39本(Open Science Collaboration, 2016, Science)
- 1576名の調査から，70%が他の研究者の研究を再現できず，50%が自分の研究の再現もできなかった(Baker, 2016, Nature)
- ヒトを対象とした恐怖条件づけもどうも再現性が低そう...

→再現しない，確実ではない行動データ（さらには行動課題中の神経データ）に対して，複雑なモデルを適用する意味は？

→計算論的アプローチの前にやるべきことがあるのでは？

---

# CPSYMAP.med[(Kato et al., preprint)]

- 計算論的精神医学研究をRDoCの分析単位とDSMなどの症状の行列上にマッピング(https://ncnp-cpsy-rmap.web.app/)

&lt;img src="pic/06.png" width="720"&gt;
---

# 単発の研究ではなくメタ分析的思考へ

- CPSYMAPでは，計算論的精神医学研究の各領域・モデルにおける蓄積具合を可視化している。

- 研究知見を追加するモジュールを追加すれば，１つのハイインパクト雑誌に掲載された論文にひっぱられた議論ではなく，メタ分析的な思考による判断が可能になるのでは？

- 独創性・ハイインパクトを重視する科学から，研究知見の積み上げとその確信度評価を重視する科学へ（心理学の社会への応用と連動させつつ）。
---

# 再現性の高いデータ収集に向けて

- 論文の紙面上で記載されている情報が少なすぎて，再現ができない可能性がある。
- 論文になってない研究室の秘伝の情報などがあるかもしれない。

→これって本当に科学？

- データ収集にかかわるマテリアルのオープン化，コラボレーション，分業化が必要？

&lt;img src="pic/21.png" width="550"&gt;
---

# 再現性の高いデータ収集に向けて

- 論文の紙面上で記載されている情報が少なすぎて，そもそも正確に研究を再現できないのでは？
- 追試しようしして，著者に問い合わせたら論文と実施した内容が違った（杣取・国里,2019)
- 仲良くなって聞くと論文になってない研究室の秘伝の方法やラボ内だけで使われているマニュアルがある

→科学ってこれでいいのか？

→データ収集にかかわるマテリアルのオープン化を進めて，コラボレーション，分業化していく必要があるのでは？

---

# The Experiment Factory

- Sochat(2018)が提唱するDockerベースにjsPsychなどの心理学での行動実験・調査を行うためのマテリアルを共有するリポジトリ
- ユーザーの環境に依存せずにすぐに実験課題を実施可能

&lt;img src="pic/21.png" width="550"&gt;
---


# Take Home Message

- 計算論的精神医学は，精神障害のメカニズム研究に有用
- 計算論的精神医学研究を推進するために使えるツールも増えてきている
- 恐怖条件づけの再発に関するモデルとして潜在原因モデルがある（能動的推論モデルの今度の展開に期待）
- 計算論的アプローチを進めつつ再現性を高める取り組みを（メタ分析，行動データ収集のオープン化）

.med[謝辞：本発表にあたり，片平健太郎さん，沖村 宰さん，山下祐一さんとの議論が不可欠でした。心より感謝申し上げます。]
---


# 引用参文献
.small[
- Kato, A., Kunisato, Y., Katahira, K., Okimura, T., &amp; Yamashita, Y. (2020). Computational Psychiatry Research Map (CPSYMAP): a New Database for Visualizing Research Papers (p. 2020.06.30.181198). https://doi.org/10.1101/2020.06.30.181198
- 国里愛彦・片平健太郎・沖村 宰・山下祐一(2019). 『計算論的精神医学: 情報処理過程から読み解く精神障害』 勁草書房
- 国里愛彦 (2018) 臨床心理学と認知モデリング　心理学評論, 61(1), 55-66.
- 杣取恵太・国里愛彦 (2019). アンヘドニア(anhedonia)と遅延割引：Lempert &amp; Pizzagalli(2010)の追試　心理学評論, 62(3), 231-243.
- Hoff, P., Maatz, A., &amp; Vetter, J. S. (2020). Diagnosis as dialogue: historical and current perspectives. Dialogues in Clinical Neuroscience, 22(1), 27–35.
- Gershman, S. J., &amp; Hartley, C. A. (2015). Individual differences in learning predict the return of fear. Learning &amp; Behavior, 43(3), 243–250.
- Gershman, S. J., Jones, C. E., Norman, K. A., Monfils, M.-H., &amp; Niv, Y. (2013). Gradual extinction prevents the return of fear: implications for the discovery of state. Frontiers in Behavioral Neuroscience, 7, 164.
- Gershman, S. J., &amp; Niv, Y. (2012). Exploring a latent cause theory of classical conditioning. Learning &amp; Behavior, 40(3), 255–268.
]
---

# 引用文献
.small[
- 中島定彦・遠座奈々子(2017). 不安症状の再発―パヴロフ型条件づけの基礎研究と理論から―. 基礎心理学研究, 35(2), 163–177.
- Sanislow, C. A., Ferrante, M., Pacheco, J., Rudorfer, M. V., &amp; Morris, S. E. (2019). Advancing Translational Research Using NIMH Research Domain Criteria and Computational Methods. Neuron, 101(5), 779–782.
- Smith, R., Moutoussis, M., &amp; Bilek, E. (2020). Simulating the computational mechanisms of cognitive and behavioral psychotherapeutic interventions: Insights from active inference. https://doi.org/10.31234/osf.io/8m62p
- Stephan, K. E., Iglesias, S., Heinzle, J., &amp; Diaconescu, A. O. (2015). Translational Perspectives for Computational Neuroimaging. Neuron, 87(4), 716–732.
- Wiecki, T. V., Poland, J., &amp; Frank, M. J. (2015). Model-Based Cognitive Neuroscience Approaches to Computational Psychiatry: Clustering and Classification. Clinical Psychological Science, 3(3), 378–399.
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
